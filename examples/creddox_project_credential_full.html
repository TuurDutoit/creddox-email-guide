<messaging:emailTemplate subject="Full credential report for the {!relatedTo.Name} project"
    recipientType="User"
    relatedToType="project_credential__c">
    
    <messaging:htmlEmailBody >
        <html>
            <head>
                <c:email_styles />
            </head>
            <body>
                <p>Dear {!recipient.Name},</p>
                <p>Here is your full project credential report for the <strong>{!relatedTo.Name}</strong> project.</p>
                <br />
                
                <h2>General</h2>
                <p><strong>Name</strong>: {!relatedTo.Name}</p>
                <p><strong>Opportunity</strong>: {!relatedTo.Opportunity__r.Name}</p>
                <p><strong>Account</strong>: {!relatedTo.Account__r.Name}</p>
                <p><strong>Industry</strong>: {!relatedTo.Account_Industry__c}</p>
                <p><strong>Lead country</strong>: {!relatedTo.Lead_Country__c}</p>
                <p><strong>Description</strong>: {!relatedTo.Project_Description__c}</p>
                <br />
                
                <h2>Record Status</h2>
                <p><strong>Original language (ORLA)</strong>: {!relatedTo.Original_Language__c}</p>
                <p><strong>Record approval status</strong>: {!relatedTo.Project_Record_Approval_Status__c}</p>
                <p><strong>Completeness score</strong>: <apex:outputField value="{!relatedTo.Completeness_Score__c}" /></p>
                <p><strong>Completeness score (CtW)</strong>: <apex:outputField value="{!relatedTo.Completeness_Score_CtW__c}" /></p>
                <p><strong>Referenceability</strong>: {!relatedTo.Referenceability__c}</p>
                <p><strong>Reference usage</strong>: {!relatedTo.Reference_Usage__c}</p>
                <p><strong>Selected for credential-to-web</strong>: {!IF(relatedTo.Selected_for_credential_to_web__c, 'yes', 'no')}</p>
                <br />
                
                <h2>Challenge</h2>
                <p><strong>Keywords</strong>: {!relatedTo.Challenge_Keywords__c}</p>
                <p><strong>Short</strong>: {!relatedTo.Challenge_Short__c}</p>
                <p><strong>Long</strong>: {!relatedTo.Challenge_Long__c}</p>
                <br />
                
                <h2>Solution</h2>
                <p><strong>Keywords</strong>: {!relatedTo.Solution_Keywords__c}</p>
                <p><strong>Short</strong>: {!relatedTo.Solution_Short__c}</p>
                <p><strong>Long</strong>: {!relatedTo.Solution_Long__c}</p>
                <br />
                
                <h2>Results</h2>
                <p><strong>Keywords</strong>: {!relatedTo.Results_Keywords__c}</p>
                <p><strong>Short</strong>: {!relatedTo.Results__c}</p>
                <p><strong>Long</strong>: {!relatedTo.Results_Long__c}</p>
                <br />
                
                <h2>Timing &amp; Size</h2>
                <p><strong>Start date</strong>: <apex:outputField value="{!relatedTo.Start_Date__c}" /></p>
                <p><strong>Duration</strong>: {!TEXT(relatedTo.Duration_in_months__c)} months</p>
                <p><strong># FTE</strong>: {!TEXT(relatedTo.FTE__c)}</p>
                <p><strong># Mandays</strong>: {!TEXT(relatedTo.Mandays__c)}</p>
                <p><strong>Contract value</strong>: <apex:outputField value="{!relatedTo.Contract_Value__c}" /></p>
                <br />
                
                <h2>Characteristics</h2>
                <p><strong>Offering line</strong>: {!relatedTo.Offering_Line__c}</p>
                <p><strong>Business process(es)</strong>: {!relatedTo.Business_Process__c}</p>
                <p><strong>Methodology</strong>: {!relatedTo.Methodology__c}</p>
                <p><strong>Geographical scope</strong>: {!relatedTo.Geographical_Scope__c}</p>
                <p><strong>Offering code</strong>: {!relatedTo.Offering_code__c}</p>
                <p><strong>Programming languages</strong>: {!relatedTo.Programming_Languages__c}</p>
                <p><strong>Technology concept</strong>: {!relatedTo.Technology_Concept__c}</p>
                <p><strong>Technology brands</strong>: {!relatedTo.Technology_Brands__c}</p>
                <br />
                
                <h2>Contact Information</h2>
                <p><strong>Contact name</strong>: {!relatedTo.Contact_Full_Name__r.Name}</p>
                <p><strong>Contact language</strong>: {!relatedTo.Contact_Language__c}</p>
                <br />
                
                <h2>Client Statements</h2>
                <apex:dataTable value="{!relatedTo.Client_Statements_on_Projects__r}" var="statement">
                    <apex:column headerValue="Full statement" value="{!statement.Full_Client_Statement__c}" />
                    <apex:column headerValue="Keywords" value="{!statement.Client_Statement_Keywords__c}" />
                    <apex:column headerValue="Contact" value="{!statement.Client_Statement_Contact__r.Name}" />
                    <apex:column headerValue="Contact title" value="{!statement.Client_Statement_Contact__r.Title}" />
                    <apex:column headerValue="Date" value="{!statement.Client_Statement_Date__c}" />
                </apex:dataTable>
                <br />
                
                <h2>Call-outs</h2>
                <apex:dataTable value="{!relatedTo.Project_Call_outs__r}" var="callout">
                    <apex:column headerValue="Call-out" value="{!callout.Call_out__c}" />
                    <apex:column headerValue="Area indications" value="{!callout.Call_out_Area_Indications__c}" />
                </apex:dataTable>
                <br />
                
                <h2>People</h2>
                <apex:dataTable value="{!relatedTo.People_Intersection__r}" var="pvp">
                    <apex:column headerValue="Name" value="{!pvp.Person_Name__c}" />
                    <apex:column headerValue="Role" value="{!pvp.Role__c}" />
                    <apex:column headerValue="Start" value="{!pvp.Assignment_Start_Date_Formatted__c}" />
                    <apex:column headerValue="End" value="{!pvp.Assignment_End_Date_Formatted__c}" />
                    <apex:column headerValue="Key person">
                        {!IF(pvp.Key_Person_on_project__c, 'yes', 'no')}
                    </apex:column>
                </apex:dataTable>
                <br />
            </body>
        </html>
    </messaging:htmlEmailBody>
</messaging:emailTemplate>
